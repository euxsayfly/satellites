clc;clear;

a=42378137;
u=3.986005e+14;
n=sqrt(u/a^3);
y10=[25100;-28867.5134594813;43301.2701892219;-1.0446;-3.6224;-1.8092];
y20=[25000;-28867.5134594813;43301.2701892219;-1.0446;-3.6224;-1.8092];
y30=[-25100;-28867.5134594813;-43301.2701892219;-1.0446;3.6145;-1.8092];

r1=sqrt((25100+a)^2+(-28867.5134594813)^2+43301.2701892219^2);
r2=sqrt((25000+a)^2+(-28867.5134594813)^2+43301.2701892219^2);
r3=sqrt((-25100+a)^2+(-28867.5134594813)^2+43301.2701892219^2);

deltvx1=(-1+1/sqrt((-1.0446-n*(-28867.5134594813))^2+(-3.6224+n*(25100+a))^2+(-1.8092)^2)*sqrt(u*(2*a-r2)/(a*r1)))*(-1.0446-n*(-28867.5134594813));
deltvy1=(-1+1/sqrt((-1.0446-n*(-28867.5134594813))^2+(-3.6224+n*(25100+a))^2+(-1.8092)^2)*sqrt(u*(2*a-r2)/(a*r1)))*(-3.6224+n*(25100+a));
deltvz1=(-1+1/sqrt((-1.0446-n*(-28867.5134594813))^2+(-3.6224+n*(25100+a))^2+(-1.8092)^2)*sqrt(u*(2*a-r2)/(a*r1)))*(-1.8092);



deltvx2=(-1+1/sqrt((-1.0446-n*(-28867.5134594813))^2+(-3.6224+n*(25000+a))^2+(-1.8092)^2)*sqrt(u*(2*a-r2)/(a*r2)))*(-1.0446-n*(-28867.5134594813));
deltvy2=(-1+1/sqrt((-1.0446-n*(-28867.5134594813))^2+(-3.6224+n*(25000+a))^2+(-1.8092)^2)*sqrt(u*(2*a-r2)/(a*r2)))*(-3.6224+n*(25000+a));
deltvz2=(-1+1/sqrt((-1.0446-n*(-28867.5134594813))^2+(-3.6224+n*(25000+a))^2+(-1.8092)^2)*sqrt(u*(2*a-r2)/(a*r2)))*(-1.8092);
deltvx3=(-1+1/sqrt((-1.0446-n*(-28867.5134594813))^2+(3.6145+n*(-25100+a))^2+(-1.8092)^2)*sqrt(u*(2*a-r3)/(a*r3)))*(-1.0446-n*(-28867.5134594813));
deltvy3=(-1+1/sqrt((-1.0446-n*(-28867.5134594813))^2+(3.6145+n*(-25100+a))^2+(-1.8092)^2)*sqrt(u*(2*a-r3)/(a*r3)))*(3.6145+n*(-25100+a));
deltvz3=(-1+1/sqrt((-1.0446-n*(-28867.5134594813))^2+(3.6145+n*(-25100+a))^2+(-1.8092)^2)*sqrt(u*(2*a-r3)/(a*r3)))*(-1.8092);
y21=y20+[0;0;0;deltvx2;deltvy2;deltvz2];
y31=y30+[0;0;0;deltvx3;deltvy3;deltvz3];
[t2,Y2]=ode45('fei',0:100:3600*24*30,y21);
[t3,Y3]=ode45('fei',0:100:3600*24*30,y31);
[t1,Y1]=ode45('fei',0:100:3600*24*30,y30);

for i=1:25921
     l23(:,i)=sqrt((Y3(i,1)-Y2(i,1))^2+(Y3(i,2)-Y2(i,2))^2+(Y3(i,3)-Y2(i,3))^2);
    l21(:,i)=sqrt((Y1(i,1)-Y2(i,1))^2+(Y1(i,2)-Y2(i,2))^2+(Y1(i,3)-Y2(i,3))^2);
 end